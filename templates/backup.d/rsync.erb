# -----------------------------------------------------------------
# /!\ DO NOT EDIT THIS FILE: it is automatically managed by Puppet
# -----------------------------------------------------------------
### backupninja RSYNC config file ###
#
# rsync handler example file
#
# Mandatory options are uncommented with sugested values
# Other options are commented out with their default values
#
# Note: You dont need to manually specify vservers using "include = /vservers".
#       They're automatically backuped if vserver is set to "yes" on you backupninja.conf.

<% if scope.lookupvar('when') != '' -%>
when = <%= scope.lookupvar('when') %>
<% end -%>

#
#
#
###################
# GENERAL SECTION #
###################
#
#
#

[general]

# rsync log file
log = <%= @log %>

# backup partition mountpoint or backup main folder
# this doesn't need to be a real partition, but should be at least the
# main folder where the backup is being stored
mountpoint = <%= @mountpoint %>

# folder relative do mountpoint where the backup should be stored
backupdir = <%= @backupdir %>

<% if days != '' %>
# number of backup increments (min = 5)
days = <%= @days %>
<% end %>

# keepdaily = for long storage format, specify the number of daily backup increments
keepdaily = <%= @keepdaily %>
# keepweekly = for long storage format, specify the number of weekly backup increments
keepweekly = <%= @keepweekly %>
# keepmonthly = for long storage format, specify the number of monthly backup increments
keepmonthly = <%= @keepmonthly %>

# use this if you need a lockfile to be kept during backup execution
# this is an useful feature in case you have some tasks that should
# know if the backup is running or not
lockfile = <%= @lockfile %>

# rsync command nice level
nicelevel = <%= @nicelevel %>

# temp folder
tmp = <%= @tmp %>

#
#
#
##################
# SOURCE SECTION #
##################
#
#
#


[source]

# where the data to be backed up is (local or remote)
from = <%= @source_type %>
<% if @source_type == 'remote' -%>

# protocol = ssh or rsync (remote source only)
protocol = <%= @source_protocol %>

# if remote source, specify the hostname or IP, port and user
host = <%= @source_host %>
port = <%= @source_port %>
user = <%= @source_user %>

# ssh key file (remote source only)
id_file = <%= @source_id_file %>

# ssh command line (remote only)
ssh = <%= @source_ssh_cmd %>

# if set to 1, compress data on rsync (remote source only)
compress = <%= @compress %>

# set a badnwidth limit in kbps (remote source only)
bandwidthlimit = <%= @source_bandwidthlimit %>

# remote rsync program (remote source only)
remote_rsync = <%= @source_remote_rsync %>
<% end -%>

# include folder on backup
<% @source_include_array.each do |inc| -%>include = <%= inc %>
<% end -%>

# exclude folder on backup
<% @source_exclude_array.each do |exc| -%>exclude = <%= exc %>
<% end -%>

# it defaults to $RSYNC value from backupninja.conf
<% if @source_rsync_cmd  != '' -%>
rsync = <%= @source_rsync_cmd %>
<% else -%>
#rsync = $RSYNC
<%end -%>

# rsync command options
rsync_options = <%= @source_rsync_options %>

# when set to 1, use numeric ids instead of user/group mappings on rsync
numericids = <%= @numericids %>

#
#
#
################
# DEST SECTION #
################
#
#
#

[dest]

# dest = backup destination type (local or remote)
dest = <%= @dest_type %>
<% if @dest_type == 'remote' -%>

# ssh command line (remote dest only)
ssh = <%= @dest_ssh_cmd %>

# protocol = ssh or rsync (remote dest only)
protocol = <%= @dest_protocol %>

# if set to 1, compress data on rsync (remote dest only)
compress = <%= @compress %>

# if remote dest, specify the hostname or IP, port and user
host = <%= @dest_host %>
port = <%= @dest_port %>
user = <%= @dest_user %>

# ssh key file (remote dest only)
id_file = <%= @dest_id_file %>

# set a badnwidth limit in kbps (remote dest only)
bandwidthlimit = <%= @dest_bandwidthlimit %>

# remote rsync program (remote dest only)
remote_rsync = <%= @dest_remote_rsync %>
<% end %>

# when set to 1, use numeric ids instead of user/group mappings on rsync
numericids = <%= @numericids %>

